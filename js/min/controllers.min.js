var appControllers=angular.module("appControllers",["ngAnimate"]);appControllers.controller("SoundController",function(e,t){e.mic=!0,e.mySketch=function(n){var r,i,a=[],o=!1,l=!1,d=$("#micSensitivity").val(),s=document.getElementById("micSensitivity"),u=document.getElementById("micOutput");s.addEventListener("input",function(){d=parseFloat(1-s.value).toFixed(1),u.value=.1==s.value?"min":.9==s.value?"max":s.value});var r;n.preload=function(){},n.setup=function(){r=new t.AudioIn,r.start();var e=.9,a=1024;i=new t.FFT(e,a),i.setInput(r),n.createCanvas(n.windowWidth,.25*n.windowHeight),n.noStroke()},n.draw=function(){n.background(122,160,175);var e=i.analyze(),t=i.waveform(),a=r.getLevel();a>d&&!o&&p(),n.noFill(),n.stroke(229,136,94),n.strokeWeight(3),n.beginShape();for(var l=0;l<e.length;l++)n.vertex(2*l,n.map(e[l],0,255,n.height,0));n.endShape(),n.noFill(),n.beginShape(),n.stroke(255),n.strokeWeight(1);for(var l=0;l<t.length;l++){var s=n.map(l,0,t.length,0,n.width),u=n.map(t[l],0,255,0,n.height);n.vertex(s,u)}n.endShape()};var p=function(){n.background(229,136,94),o=!0,e.analyzed=o;for(var t=0,r=2e4,d=25,s=0,u=0,p=0,c=[],g=t;r>g;g+=d)s=i.getEnergy(g),a.push({frequency:g,amplitude:s}),c.push([g,s]),g>=2e3&&5e3>=g&&s>u&&(u=s,p=g);var h=Math.round(i.getEnergy("bass")),m=Math.round(i.getEnergy("lowMid")),y=Math.round(i.getEnergy("mid")),v=Math.round(i.getEnergy("highMid")),b=Math.round(i.getEnergy("treble"));e.peakFrequency=p,e.peakAmplitude=u,e.bass=h,e.lowMid=m,e.mid=y,e.highMid=v,e.treble=b,e.$apply(),l=!1,$("#chart1").highcharts({chart:{type:"spline",zoomType:"x",height:480,resetZoomButton:{position:{align:"left",verticalAlign:"top"}}},colors:["#E5885E","#0066FF","#00CCFF"],credits:{enabled:!1},legend:{enabled:!1},title:{text:"Frequency Analysis (FFT)"},xAxis:{title:{text:"Frequency"}},yAxis:{title:{text:"Amplitude"},min:0,max:250,tickinterval:50},series:[{name:"Sound Capture",data:c}],exporting:{enabled:!0}}),$("#chart2").highcharts({chart:{type:"column",height:495},title:{text:"Average Energy Distribution"},colors:["#E5885E","#0066FF","#00CCFF"],credits:{enabled:!1},legend:{enabled:!1},xAxis:{categories:["Bass<br>20-140Hz","Lo-Mid<br>140-400Hz","Mid<br>400-2600Hz","Hi-Mid<br>2600-5200","Treble<br>5200-14000"],crosshair:!0,title:{text:"Frequency"}},yAxis:{min:0,max:250,tickinterval:50,title:{text:"Amplitude"}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[{name:"Sound Capture",data:[h,m,y,v,b]}]})};e.resetSound=function(t){t&&n.saveJSON(a,"audio-spectrum.json",!0),e.analyzed="",o=!1},e.setMic=function(t){"mute"==t?(r.stop(),e.mic=!1):(r.start(),e.mic=!0)},e.triggerSound=function(){l=!0,p()}}}),appControllers.controller("AnotherController",function(){});